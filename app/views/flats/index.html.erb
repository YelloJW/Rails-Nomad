<div class="container">
  <br>
  <% if @search == "" %>
    <h1>All Results</h1>
      <!-- container for map -->
      <div
        id="map"
        style="width: 100%;
        height: 500px;
        border-radius: 10px"
        data-markers = "<%= @markers.to_json %>"
        data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>"
      >
      </div>
    <div class="row mt-3">
      <% @flats.each do |flat| %>
        <div class="col-12 col-md-6 col-lg-4">
          <div class="card mt-4">
            <a href="<%= flat_path(flat) %>" class="card-link"></a>
            <% if flat.photo.attached? %>
              <%= cl_image_tag flat.photo.key, alt: "First slide", class: "card-img-top" %>
            <% else %>
              <img src="https://images.unsplash.com/photo-1536395155544-a3ba483e0b9b?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=2550&q=80" class="card-img-top">
            <% end %>

              <div class="card-body">
                <h5 class="card-title"><%= flat.name %></h5>
                <p class="card-text"><%= flat.description %></p>
                <p class="card-text"><small class="text-muted">Last booked <%= rand(1..10) %> days ago</small></p>
              </div>
          </div>
        </div>
      <% end %>
    </div>
  <% elsif Flat.where('address ILIKE ?', "%#{@search}%").exists? == false %>
    <h1>No results match your search. Please try again.</h1>
  <% else %>
      <h1>Search results for <%= @search.capitalize  %>...</h1>
      <div
        id="map"
        style="width: 100%;
        height: 500px;
        border-radius: 10px"
        data-markers = "<%= @markers.to_json %>"
        data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>"
      >
      </div>
      <div class="row mt-3">
      <% @flats.each do |flat| %>
        <div class="col-12 col-md-6 col-lg-4">
          <div class="card mt-4">
            <a href="<%= flat_path(flat) %>" class="card-link"></a>
            <% if flat.photo.attached? %>
              <%= cl_image_tag flat.photo.key, alt: "First slide", class: "card-img-top" %>
            <% else %>
              <img src="https://images.unsplash.com/photo-1536395155544-a3ba483e0b9b?ixlib=rb-1.2.1&ixid=eyJhcHBfaWQiOjEyMDd9&auto=format&fit=crop&w=2550&q=80" class="card-img-top">
            <% end %>

              <div class="card-body">
                <h5 class="card-title"><%= flat.name %></h5>
                <p class="card-text"><%= flat.description %></p>
                <p class="card-text"><small class="text-muted">Last booked <%= rand(1..10) %> days ago</small></p>
              </div>
          </div>
        </div>
      <% end %>
    </div>
  <% end %>
</div>
